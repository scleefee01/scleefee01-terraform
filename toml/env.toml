[benchmark]
JOB_NAME = "nexmark"
NAMESPACE = "flink"

PODS_DISTRIBUTION_MUTUAL_EXCLUSIVE_KEY = "gen-1"
PODS_DISTRIBUTION_GEN_NODE_SELECTOR = "null"

[benchmark.job.resources]
CPU_REQUEST = "2"
MEM_REQUEST = "2Gi"
CPU_LIMIT   = "4"
MEM_LIMIT   = "8Gi"

[benchmark.flink.resources]
CPU_REQUEST = "7"
MEM_REQUEST = "8Gi"
CPU_LIMIT   = "8"
MEM_LIMIT   = "9Gi"

[benchmark.kafka]
NAME = "kafka"
NAMESPACE = "kafka"

[benchmark.nexmark]
QUERIES = "q0"

[benchmark.nexmark.kafka]
IMAGE_TAG = "latest"
IMAGE_PULL_POLICY = "IfNotPresent"
SEPARATE_TOPICS = false
PARTITION = 8

SKIP_INSERT_KAFKA = false

MAX_EVENTS = 1000000000
GENERATOR_THREAD_NUM = 8
EVENT_RATE = 1000000
SKIP_EVENT_TYPES = ""

LOG_LEVEL = "info"


[benchmark.flink]
ENABLED = true
NAMESPACE = "flink"
IMAGE = { tag = "v1.16.0" }
TASKMANAGER_REPLICAS = 1
PARALLELISM = 8                 
TASKMANAGER_SLOTS = 8        

ENV_JAVA_OPTS = "-XX:+UseG1GC"

RESTART_STRATEGY = "fixed-delay"
RESTART_FIXED_DELAY_ATTEMPTS = 2147483647
RESTART_FIXED_DELAY_DELAY = "10s"

JOBMANAGER_MEMORY = "2048m"
TASKMANAGER_MEMORY = "8192m"
TASKMANAGER_MEMORY_MANAGED_FRACTION = 0.4

CHECKPOINT_INTERVAL = "60s"
MAX_CONCURRENT_CHECKPOINTS = 1
FINAL_CHECKPOINT_ENABLED = false

STATE_BACKEND_INCREMENTAL = true

# RocksDB tuning (matching RisingWave benchmark report)
STATE_BACKEND_ROCKSDB_BLOCK_BLOCKSIZE = "4KB"
STATE_BACKEND_ROCKSDB_THREAD_NUM = 2
STATE_BACKEND_ROCKSDB_WRITEBUFFER_COUNT = 2
STATE_BACKEND_ROCKSDB_WRITEBUFFER_NUMBER_TO_MERGE = 1
STATE_BACKEND_ROCKSDB_COMPACTION_LEVEL_USE_DYNAMIC_SIZE = false
STATE_BACKEND_ROCKSDB_COMPACTION_LEVEL_TARGET_FILE_SIZE_BASE = "64MB"
STATE_BACKEND_ROCKSDB_USE_BLOOM_FILTER = false

# Network tuning
NETWORK_MEMORY_FLOATING_BUFFERS_PER_GATE = 256
NETWORK_MEMORY_BUFFERS_PER_EXTERNAL_BLOCKING_CHANNEL = 16

S3_BUCKET = "dev-sclee01-apne1"
S3_BUCKET_FOLDER = "flink/checkpoints"

PERSISTENCE_STORAGE_CLASS = "gp2"
PERSISTENCE_SIZE = "16Gi"

IAM_ROLE_ARN = "arn:aws:iam::967157097094:role/dataeng-sclee01-iam-roles"

METRICS_LATENCY_INTERVAL = 10000
METRICS_LATENCY_GRANULARITY = "operator"

## RisingWave related variables
[benchmark.risingwave]
NAME = "benchmark-risingwave"
NAMESPACE = "risingwave"
VERSION = "v2.1.5"
LOG_LEVEL = "info"
IAM_ROLE_ARN = "arn:aws:iam::967157097094:role/dataeng-sclee01-iam-roles"

[benchmark.risingwave.replicas]
META = 1
FRONTEND = 1
COMPUTE = 1
COMPACTOR = 1
CONNECTOR = 1

[benchmark.risingwave.resources]
CPU_LIMIT = "4"
CPU_REQUEST = "0"
MEM_LIMIT = "8Gi"
MEM_REQUEST = "0"

[benchmark.risingwave.resources.compute]
CPU_LIMIT = "8"
CPU_REQUEST = "0"
MEM_LIMIT = "8Gi"
MEM_REQUEST = "0"

[benchmark.risingwave.resources.compactor]
CPU_LIMIT = "2"
CPU_REQUEST = "0"
MEM_LIMIT = "4Gi"
MEM_REQUEST = "0"

[benchmark.risingwave.storage]
TYPE = "s3"

[benchmark.risingwave.storage.s3]
REGION = "ap-northeast-1"
BUCKET = "dev-sclee01-apne1"
DATA_DIRECTORY = "hummock_001"

[benchmark.risingwave.configs]
TELEMETRY_ENABLED = false
FILE_CACHE_DIR = ""

[benchmark.risingwave.meta.memory_profiling]
ENABLE = false
LG_PROF_INTERVAL = 32
LG_PROF_SAMPLE = 19

[benchmark.risingwave.compactor.memory_profiling]
ENABLE = false
LG_PROF_INTERVAL = 38
LG_PROF_SAMPLE = 19

[benchmark.risingwave.compute.memory_profiling]
ENABLE = false
LG_PROF_INTERVAL = 40
LG_PROF_SAMPLE = 19

## Etcd related variables (for RisingWave metastore)
[benchmark.etcd]
NAME = "benchmark-etcd"
NAMESPACE = "risingwave"

[benchmark.etcd.resources]
CPU_LIMIT = "2"
CPU_REQUEST = "2"
MEM_LIMIT = "4Gi"
MEM_REQUEST = "4Gi"

[benchmark.etcd.persistence]
ENABLED = true
STORAGE_CLASS = "gp2"